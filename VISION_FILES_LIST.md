# Vision Framework - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–¥—É–ª—è Vision Framework.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
AiCleaner/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vision_config.dart                 [NEW] ‚≠ê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vision/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vision_framework.dart               [NEW] ‚≠ê –ì–ª–∞–≤–Ω—ã–π export —Ñ–∞–π–ª
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vision_analyzer.dart                [NEW] –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vision_analyzer_result.dart         [NEW] –ú–æ–¥–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vision_platform_channel.dart        [NEW] Flutter ‚Üî iOS bridge
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ analyzers/
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ blur_detection_analyzer.dart    [NEW] ‚≠ê –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ä–∞–∑–º—ã—Ç—ã—Ö —Ñ–æ—Ç–æ
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ README.md                           [NEW] üìñ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ HOW_IT_WORKS.md                     [NEW] üìñ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥—É–ª—å
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ INTEGRATION_EXAMPLE.dart            [NEW] üíª –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ feature/
‚îÇ       ‚îî‚îÄ‚îÄ cleaner/
‚îÇ           ‚îî‚îÄ‚îÄ domain/
‚îÇ               ‚îî‚îÄ‚îÄ vision_media_scanner.dart       [NEW] ‚≠ê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–ª–æ–π
‚îú‚îÄ‚îÄ ios/
‚îÇ   ‚îî‚îÄ‚îÄ Runner/
‚îÇ       ‚îú‚îÄ‚îÄ VisionFrameworkHandler.swift            [NEW] ‚≠ê iOS Vision Framework
‚îÇ       ‚îî‚îÄ‚îÄ AppDelegate.swift                       [MODIFIED] Platform channel setup
‚îú‚îÄ‚îÄ VISION_FRAMEWORK_GUIDE.md                       [NEW] üìñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (200+ —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ VISION_FRAMEWORK_SUMMARY.md                     [NEW] üìñ –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ
‚îú‚îÄ‚îÄ VISION_TESTING_CHECKLIST.md                     [NEW] ‚úÖ Checklist —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ VISION_FILES_LIST.md                            [NEW] üìã –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã)

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **lib/core/config/vision_config.dart**
  - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  - –ü–æ—Ä–æ–≥–∏ –∏ —Ç–∞–π–º–∞—É—Ç—ã

### 2. Dart/Flutter –∫–æ–¥

#### Core –º–æ–¥—É–ª—å
- **lib/core/vision/vision_analyzer.dart**
  - –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
  - –ú–µ—Ç–æ–¥—ã: `analyze()`, `analyzeMany()`, `filterFiles()`

- **lib/core/vision/vision_analyzer_result.dart**
  - –ú–æ–¥–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
  - –ü–æ–ª—è: `assetId`, `confidence`, `shouldInclude`, `metadata`

- **lib/core/vision/vision_platform_channel.dart**
  - Platform channel –¥–ª—è iOS –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
  - –ú–µ—Ç–æ–¥—ã: `isAvailable()`, `analyzeBlur()`, `analyzeBlurBatch()`

#### –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
- **lib/core/vision/analyzers/blur_detection_analyzer.dart**
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ä–∞–∑–º—ã—Ç—ã—Ö —Ñ–æ—Ç–æ
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Vision Framework —á–µ—Ä–µ–∑ platform channel

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **lib/feature/cleaner/domain/vision_media_scanner.dart**
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç Vision Framework —Å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏
  - –°—Ç—Ä–∞—Ç–µ–≥–∏–∏: Vision Primary / Classic Primary
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏

#### –£—Ç–∏–ª–∏—Ç—ã
- **lib/core/vision/vision_framework.dart**
  - Export –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π Vision Framework
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞: `import 'package:ai_cleaner_2/core/vision/vision_framework.dart';`

### 3. iOS Native –∫–æ–¥

- **ios/Runner/VisionFrameworkHandler.swift** (NEW)
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Vision Framework –Ω–∞ Swift
  - –ú–µ—Ç–æ–¥—ã: `analyzeBlur()`, `calculateBlurScore()`, `generateFeaturePrint()`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: `VNImageRequestHandler`, Laplacian variance

- **ios/Runner/AppDelegate.swift** (MODIFIED)
  - –î–æ–±–∞–≤–ª–µ–Ω platform channel `ai_cleaner/vision`
  - –ú–µ—Ç–æ–¥—ã: `isAvailable`, `analyzeBlur`, `analyzeBlurBatch`, `generateFeaturePrint`

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 1. –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
- **VISION_FRAMEWORK_GUIDE.md** (200+ —Å—Ç—Ä–æ–∫)
  - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
  - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –ø—Ä–∏–º–µ—Ä—ã
  - Troubleshooting, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  - Roadmap —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- **VISION_FRAMEWORK_SUMMARY.md**
  - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –ø—Ä–æ–µ–∫—Ç–∞
  - –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
  - –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
  - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

- **lib/core/vision/README.md**
  - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
  - –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- **lib/core/vision/HOW_IT_WORKS.md**
  - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è
  - –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö
  - –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç—ã
  - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 2. –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
- **lib/core/vision/INTEGRATION_EXAMPLE.dart**
  - 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - –ü—Ä—è–º–∞—è –∑–∞–º–µ–Ω–∞, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
  - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π rollout
  - –£–º–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **VISION_TESTING_CHECKLIST.md**
  - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
  - 10 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞
  - –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

### 4. –°–ø–∏—Å–∫–∏
- **VISION_FILES_LIST.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
  - –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
  - –û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

## üî¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: 14

- **Dart —Ñ–∞–π–ª—ã**: 7
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: 1
  - Core –º–æ–¥—É–ª—å: 3
  - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã: 1
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: 1
  - –ü—Ä–∏–º–µ—Ä—ã: 1

- **Swift —Ñ–∞–π–ª—ã**: 1
  - iOS —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: 1

- **–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ**: 1
  - AppDelegate.swift

- **Markdown –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: 5
  - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞: 4
  - –°–ø–∏—Å–∫–∏: 1

### –°—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞

- **Dart**: ~1200 —Å—Ç—Ä–æ–∫
- **Swift**: ~300 —Å—Ç—Ä–æ–∫
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: ~800 —Å—Ç—Ä–æ–∫

## üìä –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Flutter packages (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
- `flutter/foundation.dart` - debugPrint, compute
- `flutter/services.dart` - MethodChannel, PlatformException
- `photo_manager` - AssetEntity, ThumbnailSize

### iOS Frameworks (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
- `Foundation` - –±–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã
- `Vision` - Vision Framework API
- `UIKit` - UIImage, CGImage
- `Flutter` - FlutterMethodChannel

## üé® –î–∏–∞–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```
VisionConfig (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
    ‚Üì
VisionMediaScanner (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
    ‚Üì
BlurDetectionAnalyzer
    ‚Üì
VisionAnalyzer (–±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å)
    ‚Üì
VisionPlatformChannel
    ‚Üì
iOS: AppDelegate ‚Üí VisionFrameworkHandler
```

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ –º–æ–¥—É–ª—å
```dart
// lib/core/config/vision_config.dart
static const bool enabled = true;
```

### –®–∞–≥ 2: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ
```dart
import 'package:ai_cleaner_2/core/vision/vision_framework.dart';
import 'package:ai_cleaner_2/feature/cleaner/domain/vision_media_scanner.dart';
```

### –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ
```dart
final blurry = await VisionMediaScanner.findBlurryImages(photos);
```

## üì¶ –ß—Ç–æ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å?

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å Vision Framework –ø–æ–ª–Ω–æ—Å—Ç—å—é:

**–ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å (–±–µ–∑ –ø–æ–ª–æ–º–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è):**
- lib/core/vision/ (–≤—Å—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)
- lib/core/config/vision_config.dart
- lib/feature/cleaner/domain/vision_media_scanner.dart
- ios/Runner/VisionFrameworkHandler.swift
- Vision channel –∫–æ–¥ –∏–∑ AppDelegate.swift
- –í—Å–µ .md –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å VISION_*

**–ù–æ:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```dart
VisionConfig.enabled = false;
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º

–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

1. –î–æ–±–∞–≤–∏—Ç—å `similar_photos_analyzer.dart` ‚Üí VisionConfig.photo.similarPhotos
2. –î–æ–±–∞–≤–∏—Ç—å `photo_series_analyzer.dart` ‚Üí VisionConfig.photo.photoSeries
3. –î–æ–±–∞–≤–∏—Ç—å `video_blur_analyzer.dart` ‚Üí VisionConfig.video.blurDetection

## ‚úÖ Checklist –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞
- [x] –ü—Ä–∏–º–µ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [x] –¢–µ—Å—Ç–æ–≤—ã–π checklist –≥–æ—Ç–æ–≤
- [ ] –ö–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω (–≤–∞—à —à–∞–≥)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (–≤–∞—à —à–∞–≥)
- [ ] Production ready (–≤–∞—à —à–∞–≥)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-30
**–í–µ—Ä—Å–∏—è:** 1.0.0
**–ê–≤—Ç–æ—Ä:** Claude Code
